training on cuda:0
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([110, 2048])
In _Expert.forward: shape after conv:  torch.Size([110, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([21, 2048])
In _Expert.forward: shape after conv:  torch.Size([21, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([579, 2048])
In _Expert.forward: shape after conv:  torch.Size([579, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([921, 2048])
In _Expert.forward: shape after conv:  torch.Size([921, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([276, 2048])
In _Expert.forward: shape after conv:  torch.Size([276, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1942, 2048])
In _Expert.forward: shape after conv:  torch.Size([1942, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([26, 2048])
In _Expert.forward: shape after conv:  torch.Size([26, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([221, 2048])
In _Expert.forward: shape after conv:  torch.Size([221, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([301, 2048])
In _Expert.forward: shape after conv:  torch.Size([301, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([7, 2048])
In _Expert.forward: shape after conv:  torch.Size([7, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([518, 2048])
In _Expert.forward: shape after conv:  torch.Size([518, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1099, 2048])
In _Expert.forward: shape after conv:  torch.Size([1099, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([9, 2048])
In _Expert.forward: shape after conv:  torch.Size([9, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([27, 2048])
In _Expert.forward: shape after conv:  torch.Size([27, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([87, 2048])
In _Expert.forward: shape after conv:  torch.Size([87, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([26, 2048])
In _Expert.forward: shape after conv:  torch.Size([26, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([5, 2048])
In _Expert.forward: shape after conv:  torch.Size([5, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([904, 2048])
In _Expert.forward: shape after conv:  torch.Size([904, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([772, 2048])
In _Expert.forward: shape after conv:  torch.Size([772, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([59, 2048])
In _Expert.forward: shape after conv:  torch.Size([59, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([62, 2048])
In _Expert.forward: shape after conv:  torch.Size([62, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([220, 2048])
In _Expert.forward: shape after conv:  torch.Size([220, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([301, 2048])
In _Expert.forward: shape after conv:  torch.Size([301, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2, 2048])
In _Expert.forward: shape after conv:  torch.Size([2, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([507, 2048])
In _Expert.forward: shape after conv:  torch.Size([507, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([697, 2048])
In _Expert.forward: shape after conv:  torch.Size([697, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([10, 2048])
In _Expert.forward: shape after conv:  torch.Size([10, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([54, 2048])
In _Expert.forward: shape after conv:  torch.Size([54, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([477, 2048])
In _Expert.forward: shape after conv:  torch.Size([477, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([49, 2048])
In _Expert.forward: shape after conv:  torch.Size([49, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2, 2048])
In _Expert.forward: shape after conv:  torch.Size([2, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1063, 2048])
In _Expert.forward: shape after conv:  torch.Size([1063, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([660, 2048])
In _Expert.forward: shape after conv:  torch.Size([660, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1, 2048])
In _Expert.forward: shape after conv:  torch.Size([1, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2041, 2048])
In _Expert.forward: shape after conv:  torch.Size([2041, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1, 2048])
In _Expert.forward: shape after conv:  torch.Size([1, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([279, 2048])
In _Expert.forward: shape after conv:  torch.Size([279, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([101, 2048])
In _Expert.forward: shape after conv:  torch.Size([101, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([20, 2048])
In _Expert.forward: shape after conv:  torch.Size([20, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([532, 2048])
In _Expert.forward: shape after conv:  torch.Size([532, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([984, 2048])
In _Expert.forward: shape after conv:  torch.Size([984, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([10, 2048])
In _Expert.forward: shape after conv:  torch.Size([10, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([67, 2048])
In _Expert.forward: shape after conv:  torch.Size([67, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([334, 2048])
In _Expert.forward: shape after conv:  torch.Size([334, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([46, 2048])
In _Expert.forward: shape after conv:  torch.Size([46, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([33, 2048])
In _Expert.forward: shape after conv:  torch.Size([33, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([252, 2048])
In _Expert.forward: shape after conv:  torch.Size([252, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1212, 2048])
In _Expert.forward: shape after conv:  torch.Size([1212, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([24, 2048])
In _Expert.forward: shape after conv:  torch.Size([24, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([72, 2048])
In _Expert.forward: shape after conv:  torch.Size([72, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([409, 2048])
In _Expert.forward: shape after conv:  torch.Size([409, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([58, 2048])
In _Expert.forward: shape after conv:  torch.Size([58, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([11, 2048])
In _Expert.forward: shape after conv:  torch.Size([11, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([297, 2048])
In _Expert.forward: shape after conv:  torch.Size([297, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1300, 2048])
In _Expert.forward: shape after conv:  torch.Size([1300, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([18, 2048])
In _Expert.forward: shape after conv:  torch.Size([18, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([56, 2048])
In _Expert.forward: shape after conv:  torch.Size([56, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([308, 2048])
In _Expert.forward: shape after conv:  torch.Size([308, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([79, 2048])
In _Expert.forward: shape after conv:  torch.Size([79, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([6, 2048])
In _Expert.forward: shape after conv:  torch.Size([6, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([217, 2048])
In _Expert.forward: shape after conv:  torch.Size([217, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1366, 2048])
In _Expert.forward: shape after conv:  torch.Size([1366, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([22, 2048])
In _Expert.forward: shape after conv:  torch.Size([22, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([15, 2048])
In _Expert.forward: shape after conv:  torch.Size([15, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([343, 2048])
In _Expert.forward: shape after conv:  torch.Size([343, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([96, 2048])
In _Expert.forward: shape after conv:  torch.Size([96, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([8, 2048])
In _Expert.forward: shape after conv:  torch.Size([8, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([252, 2048])
In _Expert.forward: shape after conv:  torch.Size([252, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1296, 2048])
In _Expert.forward: shape after conv:  torch.Size([1296, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([14, 2048])
In _Expert.forward: shape after conv:  torch.Size([14, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([23, 2048])
In _Expert.forward: shape after conv:  torch.Size([23, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([359, 2048])
In _Expert.forward: shape after conv:  torch.Size([359, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([91, 2048])
In _Expert.forward: shape after conv:  torch.Size([91, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([9, 2048])
In _Expert.forward: shape after conv:  torch.Size([9, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([224, 2048])
In _Expert.forward: shape after conv:  torch.Size([224, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1319, 2048])
In _Expert.forward: shape after conv:  torch.Size([1319, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([10, 2048])
In _Expert.forward: shape after conv:  torch.Size([10, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([17, 2048])
In _Expert.forward: shape after conv:  torch.Size([17, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([378, 2048])
In _Expert.forward: shape after conv:  torch.Size([378, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([120, 2048])
In _Expert.forward: shape after conv:  torch.Size([120, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([8, 2048])
In _Expert.forward: shape after conv:  torch.Size([8, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([283, 2048])
In _Expert.forward: shape after conv:  torch.Size([283, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1253, 2048])
In _Expert.forward: shape after conv:  torch.Size([1253, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([13, 2048])
In _Expert.forward: shape after conv:  torch.Size([13, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([30, 2048])
In _Expert.forward: shape after conv:  torch.Size([30, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([341, 2048])
In _Expert.forward: shape after conv:  torch.Size([341, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([110, 2048])
In _Expert.forward: shape after conv:  torch.Size([110, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([7, 2048])
In _Expert.forward: shape after conv:  torch.Size([7, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([339, 2048])
In _Expert.forward: shape after conv:  torch.Size([339, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1116, 2048])
In _Expert.forward: shape after conv:  torch.Size([1116, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([46, 2048])
In _Expert.forward: shape after conv:  torch.Size([46, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([18, 2048])
In _Expert.forward: shape after conv:  torch.Size([18, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([412, 2048])
In _Expert.forward: shape after conv:  torch.Size([412, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([146, 2048])
In _Expert.forward: shape after conv:  torch.Size([146, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([5, 2048])
In _Expert.forward: shape after conv:  torch.Size([5, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([371, 2048])
In _Expert.forward: shape after conv:  torch.Size([371, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1009, 2048])
In _Expert.forward: shape after conv:  torch.Size([1009, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([30, 2048])
In _Expert.forward: shape after conv:  torch.Size([30, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([19, 2048])
In _Expert.forward: shape after conv:  torch.Size([19, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([468, 2048])
In _Expert.forward: shape after conv:  torch.Size([468, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([189, 2048])
In _Expert.forward: shape after conv:  torch.Size([189, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([6, 2048])
In _Expert.forward: shape after conv:  torch.Size([6, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([395, 2048])
In _Expert.forward: shape after conv:  torch.Size([395, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([897, 2048])
In _Expert.forward: shape after conv:  torch.Size([897, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([49, 2048])
In _Expert.forward: shape after conv:  torch.Size([49, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([28, 2048])
In _Expert.forward: shape after conv:  torch.Size([28, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([484, 2048])
In _Expert.forward: shape after conv:  torch.Size([484, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([193, 2048])
In _Expert.forward: shape after conv:  torch.Size([193, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([4, 2048])
In _Expert.forward: shape after conv:  torch.Size([4, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([435, 2048])
In _Expert.forward: shape after conv:  torch.Size([435, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([903, 2048])
In _Expert.forward: shape after conv:  torch.Size([903, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([40, 2048])
In _Expert.forward: shape after conv:  torch.Size([40, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([53, 2048])
In _Expert.forward: shape after conv:  torch.Size([53, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([420, 2048])
In _Expert.forward: shape after conv:  torch.Size([420, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([98, 2048])
In _Expert.forward: shape after conv:  torch.Size([98, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([6, 2048])
In _Expert.forward: shape after conv:  torch.Size([6, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([364, 2048])
In _Expert.forward: shape after conv:  torch.Size([364, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1204, 2048])
In _Expert.forward: shape after conv:  torch.Size([1204, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([10, 2048])
In _Expert.forward: shape after conv:  torch.Size([10, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([16, 2048])
In _Expert.forward: shape after conv:  torch.Size([16, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([350, 2048])
In _Expert.forward: shape after conv:  torch.Size([350, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([168, 2048])
In _Expert.forward: shape after conv:  torch.Size([168, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([6, 2048])
In _Expert.forward: shape after conv:  torch.Size([6, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([315, 2048])
In _Expert.forward: shape after conv:  torch.Size([315, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1108, 2048])
In _Expert.forward: shape after conv:  torch.Size([1108, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([25, 2048])
In _Expert.forward: shape after conv:  torch.Size([25, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([28, 2048])
In _Expert.forward: shape after conv:  torch.Size([28, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([398, 2048])
In _Expert.forward: shape after conv:  torch.Size([398, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([123, 2048])
In _Expert.forward: shape after conv:  torch.Size([123, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([5, 2048])
In _Expert.forward: shape after conv:  torch.Size([5, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([329, 2048])
In _Expert.forward: shape after conv:  torch.Size([329, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([991, 2048])
In _Expert.forward: shape after conv:  torch.Size([991, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([34, 2048])
In _Expert.forward: shape after conv:  torch.Size([34, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([46, 2048])
In _Expert.forward: shape after conv:  torch.Size([46, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([520, 2048])
In _Expert.forward: shape after conv:  torch.Size([520, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([109, 2048])
In _Expert.forward: shape after conv:  torch.Size([109, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([5, 2048])
In _Expert.forward: shape after conv:  torch.Size([5, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([309, 2048])
In _Expert.forward: shape after conv:  torch.Size([309, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1013, 2048])
In _Expert.forward: shape after conv:  torch.Size([1013, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([35, 2048])
In _Expert.forward: shape after conv:  torch.Size([35, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([41, 2048])
In _Expert.forward: shape after conv:  torch.Size([41, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([536, 2048])
In _Expert.forward: shape after conv:  torch.Size([536, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([110, 2048])
In _Expert.forward: shape after conv:  torch.Size([110, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([7, 2048])
In _Expert.forward: shape after conv:  torch.Size([7, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([509, 2048])
In _Expert.forward: shape after conv:  torch.Size([509, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([847, 2048])
In _Expert.forward: shape after conv:  torch.Size([847, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([31, 2048])
In _Expert.forward: shape after conv:  torch.Size([31, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([42, 2048])
In _Expert.forward: shape after conv:  torch.Size([42, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([502, 2048])
In _Expert.forward: shape after conv:  torch.Size([502, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([82, 2048])
In _Expert.forward: shape after conv:  torch.Size([82, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([10, 2048])
In _Expert.forward: shape after conv:  torch.Size([10, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([318, 2048])
In _Expert.forward: shape after conv:  torch.Size([318, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([965, 2048])
In _Expert.forward: shape after conv:  torch.Size([965, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([18, 2048])
In _Expert.forward: shape after conv:  torch.Size([18, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([67, 2048])
In _Expert.forward: shape after conv:  torch.Size([67, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([588, 2048])
In _Expert.forward: shape after conv:  torch.Size([588, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([104, 2048])
In _Expert.forward: shape after conv:  torch.Size([104, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([4, 2048])
In _Expert.forward: shape after conv:  torch.Size([4, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([289, 2048])
In _Expert.forward: shape after conv:  torch.Size([289, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([999, 2048])
In _Expert.forward: shape after conv:  torch.Size([999, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([27, 2048])
In _Expert.forward: shape after conv:  torch.Size([27, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([64, 2048])
In _Expert.forward: shape after conv:  torch.Size([64, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([561, 2048])
In _Expert.forward: shape after conv:  torch.Size([561, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([102, 2048])
In _Expert.forward: shape after conv:  torch.Size([102, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1, 2048])
In _Expert.forward: shape after conv:  torch.Size([1, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([294, 2048])
In _Expert.forward: shape after conv:  torch.Size([294, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([999, 2048])
In _Expert.forward: shape after conv:  torch.Size([999, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([44, 2048])
In _Expert.forward: shape after conv:  torch.Size([44, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([60, 2048])
In _Expert.forward: shape after conv:  torch.Size([60, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([548, 2048])
In _Expert.forward: shape after conv:  torch.Size([548, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([97, 2048])
In _Expert.forward: shape after conv:  torch.Size([97, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([7, 2048])
In _Expert.forward: shape after conv:  torch.Size([7, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([320, 2048])
In _Expert.forward: shape after conv:  torch.Size([320, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([920, 2048])
In _Expert.forward: shape after conv:  torch.Size([920, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([36, 2048])
In _Expert.forward: shape after conv:  torch.Size([36, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([77, 2048])
In _Expert.forward: shape after conv:  torch.Size([77, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([591, 2048])
In _Expert.forward: shape after conv:  torch.Size([591, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([86, 2048])
In _Expert.forward: shape after conv:  torch.Size([86, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2, 2048])
In _Expert.forward: shape after conv:  torch.Size([2, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([327, 2048])
In _Expert.forward: shape after conv:  torch.Size([327, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([955, 2048])
In _Expert.forward: shape after conv:  torch.Size([955, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([37, 2048])
In _Expert.forward: shape after conv:  torch.Size([37, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([99, 2048])
In _Expert.forward: shape after conv:  torch.Size([99, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([542, 2048])
In _Expert.forward: shape after conv:  torch.Size([542, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([79, 2048])
In _Expert.forward: shape after conv:  torch.Size([79, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([11, 2048])
In _Expert.forward: shape after conv:  torch.Size([11, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([339, 2048])
In _Expert.forward: shape after conv:  torch.Size([339, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([907, 2048])
In _Expert.forward: shape after conv:  torch.Size([907, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([43, 2048])
In _Expert.forward: shape after conv:  torch.Size([43, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([85, 2048])
In _Expert.forward: shape after conv:  torch.Size([85, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([584, 2048])
In _Expert.forward: shape after conv:  torch.Size([584, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([79, 2048])
In _Expert.forward: shape after conv:  torch.Size([79, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([5, 2048])
In _Expert.forward: shape after conv:  torch.Size([5, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([332, 2048])
In _Expert.forward: shape after conv:  torch.Size([332, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([917, 2048])
In _Expert.forward: shape after conv:  torch.Size([917, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([43, 2048])
In _Expert.forward: shape after conv:  torch.Size([43, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([85, 2048])
In _Expert.forward: shape after conv:  torch.Size([85, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([587, 2048])
In _Expert.forward: shape after conv:  torch.Size([587, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([54, 2048])
In _Expert.forward: shape after conv:  torch.Size([54, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([8, 2048])
In _Expert.forward: shape after conv:  torch.Size([8, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([213, 2048])
In _Expert.forward: shape after conv:  torch.Size([213, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1116, 2048])
In _Expert.forward: shape after conv:  torch.Size([1116, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([38, 2048])
In _Expert.forward: shape after conv:  torch.Size([38, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([104, 2048])
In _Expert.forward: shape after conv:  torch.Size([104, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([515, 2048])
In _Expert.forward: shape after conv:  torch.Size([515, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([608, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([24, 2048])
In _Expert.forward: shape after conv:  torch.Size([24, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([0, 2048])
In _Expert.forward: shape after conv:  torch.Size([0, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([77, 2048])
In _Expert.forward: shape after conv:  torch.Size([77, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([291, 2048])
In _Expert.forward: shape after conv:  torch.Size([291, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([13, 2048])
In _Expert.forward: shape after conv:  torch.Size([13, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([608, 2048])
In _Expert.forward: shape after conv:  torch.Size([608, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([31, 2048])
In _Expert.forward: shape after conv:  torch.Size([31, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([172, 2048])
In _Expert.forward: shape after conv:  torch.Size([172, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([608, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([3, 2048])
In _Expert.forward: shape after conv:  torch.Size([3, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([8, 2048])
In _Expert.forward: shape after conv:  torch.Size([8, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1276, 2048])
In _Expert.forward: shape after conv:  torch.Size([1276, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([752, 2048])
In _Expert.forward: shape after conv:  torch.Size([752, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([7, 2048])
In _Expert.forward: shape after conv:  torch.Size([7, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([0, 2048])
In _Expert.forward: shape after conv:  torch.Size([0, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2, 2048])
In _Expert.forward: shape after conv:  torch.Size([2, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2, 2048])
In _Expert.forward: shape after conv:  torch.Size([2, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([8, 2048])
In _Expert.forward: shape after conv:  torch.Size([8, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1286, 2048])
In _Expert.forward: shape after conv:  torch.Size([1286, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([748, 2048])
In _Expert.forward: shape after conv:  torch.Size([748, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([3, 2048])
In _Expert.forward: shape after conv:  torch.Size([3, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([0, 2048])
In _Expert.forward: shape after conv:  torch.Size([0, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1, 2048])
In _Expert.forward: shape after conv:  torch.Size([1, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([3, 2048])
In _Expert.forward: shape after conv:  torch.Size([3, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2, 2048])
In _Expert.forward: shape after conv:  torch.Size([2, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1291, 2048])
In _Expert.forward: shape after conv:  torch.Size([1291, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([745, 2048])
In _Expert.forward: shape after conv:  torch.Size([745, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([5, 2048])
In _Expert.forward: shape after conv:  torch.Size([5, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([0, 2048])
In _Expert.forward: shape after conv:  torch.Size([0, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2, 2048])
In _Expert.forward: shape after conv:  torch.Size([2, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([5, 2048])
In _Expert.forward: shape after conv:  torch.Size([5, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1, 2048])
In _Expert.forward: shape after conv:  torch.Size([1, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1287, 2048])
In _Expert.forward: shape after conv:  torch.Size([1287, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([744, 2048])
In _Expert.forward: shape after conv:  torch.Size([744, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([10, 2048])
In _Expert.forward: shape after conv:  torch.Size([10, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([0, 2048])
In _Expert.forward: shape after conv:  torch.Size([0, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1, 2048])
In _Expert.forward: shape after conv:  torch.Size([1, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([1808, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([0, 2048])
In _Expert.forward: shape after conv:  torch.Size([0, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([8, 2048])
In _Expert.forward: shape after conv:  torch.Size([8, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1115, 2048])
In _Expert.forward: shape after conv:  torch.Size([1115, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([676, 2048])
In _Expert.forward: shape after conv:  torch.Size([676, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([5, 2048])
In _Expert.forward: shape after conv:  torch.Size([5, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1808, 2048])
In _Expert.forward: shape after conv:  torch.Size([1808, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([0, 2048])
In _Expert.forward: shape after conv:  torch.Size([0, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([4, 2048])
In _Expert.forward: shape after conv:  torch.Size([4, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([1808, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([82, 2048])
In _Expert.forward: shape after conv:  torch.Size([82, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([6, 2048])
In _Expert.forward: shape after conv:  torch.Size([6, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([351, 2048])
In _Expert.forward: shape after conv:  torch.Size([351, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([993, 2048])
In _Expert.forward: shape after conv:  torch.Size([993, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([23, 2048])
In _Expert.forward: shape after conv:  torch.Size([23, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([43, 2048])
In _Expert.forward: shape after conv:  torch.Size([43, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([550, 2048])
In _Expert.forward: shape after conv:  torch.Size([550, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([109, 2048])
In _Expert.forward: shape after conv:  torch.Size([109, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2, 2048])
In _Expert.forward: shape after conv:  torch.Size([2, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([347, 2048])
In _Expert.forward: shape after conv:  torch.Size([347, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([900, 2048])
In _Expert.forward: shape after conv:  torch.Size([900, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([53, 2048])
In _Expert.forward: shape after conv:  torch.Size([53, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([74, 2048])
In _Expert.forward: shape after conv:  torch.Size([74, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([563, 2048])
In _Expert.forward: shape after conv:  torch.Size([563, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([98, 2048])
In _Expert.forward: shape after conv:  torch.Size([98, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2, 2048])
In _Expert.forward: shape after conv:  torch.Size([2, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([328, 2048])
In _Expert.forward: shape after conv:  torch.Size([328, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1023, 2048])
In _Expert.forward: shape after conv:  torch.Size([1023, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([31, 2048])
In _Expert.forward: shape after conv:  torch.Size([31, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([48, 2048])
In _Expert.forward: shape after conv:  torch.Size([48, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([518, 2048])
In _Expert.forward: shape after conv:  torch.Size([518, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([85, 2048])
In _Expert.forward: shape after conv:  torch.Size([85, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([3, 2048])
In _Expert.forward: shape after conv:  torch.Size([3, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([282, 2048])
In _Expert.forward: shape after conv:  torch.Size([282, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([960, 2048])
In _Expert.forward: shape after conv:  torch.Size([960, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([80, 2048])
In _Expert.forward: shape after conv:  torch.Size([80, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([94, 2048])
In _Expert.forward: shape after conv:  torch.Size([94, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([544, 2048])
In _Expert.forward: shape after conv:  torch.Size([544, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([100, 2048])
In _Expert.forward: shape after conv:  torch.Size([100, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([4, 2048])
In _Expert.forward: shape after conv:  torch.Size([4, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([258, 2048])
In _Expert.forward: shape after conv:  torch.Size([258, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1005, 2048])
In _Expert.forward: shape after conv:  torch.Size([1005, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([34, 2048])
In _Expert.forward: shape after conv:  torch.Size([34, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([80, 2048])
In _Expert.forward: shape after conv:  torch.Size([80, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([567, 2048])
In _Expert.forward: shape after conv:  torch.Size([567, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([98, 2048])
In _Expert.forward: shape after conv:  torch.Size([98, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([6, 2048])
In _Expert.forward: shape after conv:  torch.Size([6, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([259, 2048])
In _Expert.forward: shape after conv:  torch.Size([259, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1012, 2048])
In _Expert.forward: shape after conv:  torch.Size([1012, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([53, 2048])
In _Expert.forward: shape after conv:  torch.Size([53, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([94, 2048])
In _Expert.forward: shape after conv:  torch.Size([94, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([526, 2048])
In _Expert.forward: shape after conv:  torch.Size([526, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([72, 2048])
In _Expert.forward: shape after conv:  torch.Size([72, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([4, 2048])
In _Expert.forward: shape after conv:  torch.Size([4, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([272, 2048])
In _Expert.forward: shape after conv:  torch.Size([272, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1001, 2048])
In _Expert.forward: shape after conv:  torch.Size([1001, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([27, 2048])
In _Expert.forward: shape after conv:  torch.Size([27, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([88, 2048])
In _Expert.forward: shape after conv:  torch.Size([88, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([584, 2048])
In _Expert.forward: shape after conv:  torch.Size([584, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([92, 2048])
In _Expert.forward: shape after conv:  torch.Size([92, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([4, 2048])
In _Expert.forward: shape after conv:  torch.Size([4, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([270, 2048])
In _Expert.forward: shape after conv:  torch.Size([270, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([989, 2048])
In _Expert.forward: shape after conv:  torch.Size([989, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([40, 2048])
In _Expert.forward: shape after conv:  torch.Size([40, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([66, 2048])
In _Expert.forward: shape after conv:  torch.Size([66, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([587, 2048])
In _Expert.forward: shape after conv:  torch.Size([587, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([111, 2048])
In _Expert.forward: shape after conv:  torch.Size([111, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([5, 2048])
In _Expert.forward: shape after conv:  torch.Size([5, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([286, 2048])
In _Expert.forward: shape after conv:  torch.Size([286, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([972, 2048])
In _Expert.forward: shape after conv:  torch.Size([972, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([40, 2048])
In _Expert.forward: shape after conv:  torch.Size([40, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([69, 2048])
In _Expert.forward: shape after conv:  torch.Size([69, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([565, 2048])
In _Expert.forward: shape after conv:  torch.Size([565, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([104, 2048])
In _Expert.forward: shape after conv:  torch.Size([104, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([12, 2048])
In _Expert.forward: shape after conv:  torch.Size([12, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([304, 2048])
In _Expert.forward: shape after conv:  torch.Size([304, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([941, 2048])
In _Expert.forward: shape after conv:  torch.Size([941, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([46, 2048])
In _Expert.forward: shape after conv:  torch.Size([46, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([77, 2048])
In _Expert.forward: shape after conv:  torch.Size([77, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([564, 2048])
In _Expert.forward: shape after conv:  torch.Size([564, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([105, 2048])
In _Expert.forward: shape after conv:  torch.Size([105, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2, 2048])
In _Expert.forward: shape after conv:  torch.Size([2, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([379, 2048])
In _Expert.forward: shape after conv:  torch.Size([379, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([837, 2048])
In _Expert.forward: shape after conv:  torch.Size([837, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([37, 2048])
In _Expert.forward: shape after conv:  torch.Size([37, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([84, 2048])
In _Expert.forward: shape after conv:  torch.Size([84, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([604, 2048])
In _Expert.forward: shape after conv:  torch.Size([604, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([101, 2048])
In _Expert.forward: shape after conv:  torch.Size([101, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2, 2048])
In _Expert.forward: shape after conv:  torch.Size([2, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([294, 2048])
In _Expert.forward: shape after conv:  torch.Size([294, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1022, 2048])
In _Expert.forward: shape after conv:  torch.Size([1022, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([33, 2048])
In _Expert.forward: shape after conv:  torch.Size([33, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([91, 2048])
In _Expert.forward: shape after conv:  torch.Size([91, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([505, 2048])
In _Expert.forward: shape after conv:  torch.Size([505, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([85, 2048])
In _Expert.forward: shape after conv:  torch.Size([85, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([5, 2048])
In _Expert.forward: shape after conv:  torch.Size([5, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([358, 2048])
In _Expert.forward: shape after conv:  torch.Size([358, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([966, 2048])
In _Expert.forward: shape after conv:  torch.Size([966, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([43, 2048])
In _Expert.forward: shape after conv:  torch.Size([43, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([105, 2048])
In _Expert.forward: shape after conv:  torch.Size([105, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([486, 2048])
In _Expert.forward: shape after conv:  torch.Size([486, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([63, 2048])
In _Expert.forward: shape after conv:  torch.Size([63, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([8, 2048])
In _Expert.forward: shape after conv:  torch.Size([8, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([316, 2048])
In _Expert.forward: shape after conv:  torch.Size([316, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1091, 2048])
In _Expert.forward: shape after conv:  torch.Size([1091, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([36, 2048])
In _Expert.forward: shape after conv:  torch.Size([36, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([94, 2048])
In _Expert.forward: shape after conv:  torch.Size([94, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([440, 2048])
In _Expert.forward: shape after conv:  torch.Size([440, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([107, 2048])
In _Expert.forward: shape after conv:  torch.Size([107, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([3, 2048])
In _Expert.forward: shape after conv:  torch.Size([3, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([319, 2048])
In _Expert.forward: shape after conv:  torch.Size([319, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([982, 2048])
In _Expert.forward: shape after conv:  torch.Size([982, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([37, 2048])
In _Expert.forward: shape after conv:  torch.Size([37, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([84, 2048])
In _Expert.forward: shape after conv:  torch.Size([84, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([516, 2048])
In _Expert.forward: shape after conv:  torch.Size([516, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
In class FMoEResNetConv: original_shape:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([102, 2048])
In _Expert.forward: shape after conv:  torch.Size([102, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([8, 2048])
In _Expert.forward: shape after conv:  torch.Size([8, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([309, 2048])
In _Expert.forward: shape after conv:  torch.Size([309, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([1000, 2048])
In _Expert.forward: shape after conv:  torch.Size([1000, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([48, 2048])
In _Expert.forward: shape after conv:  torch.Size([48, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([2048, 2048])
In _Expert.forward: shape after conv:  torch.Size([2048, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([118, 2048])
In _Expert.forward: shape after conv:  torch.Size([118, 128, 4, 4])
In _Expert.forward: original_shape:  torch.Size([463, 2048])
In _Expert.forward: shape after conv:  torch.Size([463, 128, 4, 4])
In class FMoEResNetConv: output_shape:  torch.Size([2048, 2048])
